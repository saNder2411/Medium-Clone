import React, {useState, useEffect} from 'react';
import Auth from 'pages/auth/auth';
import withService from 'hocs/with-service/with-service';


const AuthContainer = ({service}) => {
  const [email, setEmail] = useState(``);
  const [password, setPassword] = useState(``);
  const [isSubmmitting, setIsSubmitting] = useState(false);

  useEffect(() => {
    if (!isSubmmitting) {
      return;
    }

    service.logInUser({email, password})
      .then((res) => {
        console.log(res);
        setIsSubmitting(false);
      })
      .catch((err) => {
        console.log(err);
        setIsSubmitting(false);
      });

  }, [email, password, service, isSubmmitting]);

  const handleFormSubmit = (evt) => {
    evt.preventDefault();
    setIsSubmitting(true);
  };

  return (
    <Auth
      email={email}
      password={password}
      isSubmmitting={isSubmmitting}
      setEmail={setEmail}
      setPassword={setPassword}
      onFormSubmit={handleFormSubmit} />);
};

export default withService(AuthContainer);